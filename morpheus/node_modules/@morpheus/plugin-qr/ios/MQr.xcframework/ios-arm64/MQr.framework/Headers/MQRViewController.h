//
//  MQRViewController.h
//

#import "MQRCodeViewController.h"
#import <AVFoundation/AVFoundation.h>


typedef void(^MQRViewControllerTakeHandler)(NSDictionary *data, BOOL cancelled, BOOL closed);

@interface NSString(MQRViewController)

- (MQrFilterType)filterTypeFromString;

@end

@interface MQrMaskView : UIView

@property (nonatomic, strong) IBOutlet UIView *masOddkView;


@end

@interface MQRViewController : PPNativeViewController
{
    AVCaptureVideoPreviewLayer * _videoPreviewLayer;
    AVCaptureMetadataOutput * _captureMetadataOutput;
}

@property (nonatomic, readwrite) MQrFilterType filterType;
@property (nonatomic, retain) NSArray *filterTypes;
@property (nonatomic, readwrite) CGSize captureScale;
@property (nonatomic, readwrite) MQrLibraryType libraryType;

@property (nonatomic, strong) IBOutlet UIView *captureView;
@property (nonatomic, strong) IBOutlet MQrMaskView *maskView;
@property (nonatomic, strong) IBOutlet UIView *uiCenterView;
@property (nonatomic, readwrite) int oddMargin;

@property (nonatomic, strong) IBOutlet UIView *userInterfaceView;
@property (nonatomic, strong) IBOutlet UILabel *titleLabel;
@property (nonatomic, strong) IBOutlet UILabel *textLabel;
@property (nonatomic, strong) IBOutlet UIButton *cancelButton;
@property (nonatomic, strong) IBOutlet UIButton *flashButton;

@property (nonatomic, readwrite) BOOL useGuideLine;
@property (nonatomic, readwrite, getter=isFlashOn) BOOL flashOn;
@property (nonatomic, readwrite, getter=isFadeToggle) BOOL fadeToggle;
@property (nonatomic, readonly, getter=isScanned) BOOL scanned;
@property (nonatomic, strong) MQRViewControllerTakeHandler takeHandler;

//UI관련
- (void)updateScanCrop;
- (void)didUpdateScanCrop;

- (BOOL)useGuideLine;
- (void)setUseGuideLine:(BOOL)useGuideLine;
- (void)setFlashOn:(BOOL)flashOn;
- (void)didFlashOn:(BOOL)flashOn;
- (IBAction)onClickCancelButton:(id)sender;
- (IBAction)onToggleFlashButton:(id)sender;
- (void)readerStop;
- (void)readerStart;
- (void)close:(NSDictionary *)data cancelled:(BOOL)cancelled;


@end
