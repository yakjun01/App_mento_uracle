import { l as libExports } from './vendor.DEZAgNuY.js';
import { S as Subprocess } from './subprocess.s7bh3ENM.js';
import 'path';
import 'os';
import 'url';
import { A as AppConfig } from './AppConfig.BjmXUQ7C.js';
import { A as AssetService, a as AndroidService, I as IosService } from './IosService.CFdTbh92.js';
import { A as AppService } from './AppService.Bv5LpPwI.js';
import 'node:events';
import 'node:child_process';
import 'node:path';
import 'node:fs';
import 'node:process';
import 'util';
import 'stream';
import 'buffer';
import 'events';
import 'fs';
import 'zlib';
import 'tty';
import 'string_decoder';
import 'http';
import 'https';
import 'crypto';
import 'constants';
import 'assert';
import 'child_process';
import 'node:crypto';
import 'node:os';
import 'node:fs/promises';
import 'node:string_decoder';
import 'domain';
import 'node:stream';
import 'http2';
import 'net';
import 'tls';
import './index.BBihg1b8.js';
import './SDKService.DqbWTl4i.js';
import './zip.Urfv9crQ.js';

async function run() {
    const rootDir = process.cwd();
    const appConfig = new AppConfig(rootDir);
    await appConfig.load();
    const appService = new AppService(appConfig);
    const assetsService = new AssetService(appConfig.assetDir);
    const androidService = new AndroidService(appConfig.androidDir);
    const usedIos = await libExports.pathExists(appConfig.iosDir);
    const libraries = await appService.loadInstalledLibraries();
    const tasks = [
        assetsService.syncLegacyWebLibraries(libraries, appConfig.legacyJsOutPut),
        assetsService.syncManifestLibraries(libraries, appConfig.manifestExt),
        androidService.syncLibraries(libraries),
    ];
    if (usedIos) {
        const iosService = new IosService(appConfig.iosDir);
        tasks.push(iosService.syncLibraries(libraries));
    }
    await Promise.all(tasks);
    if (!usedIos)
        return;
    // iOS의 경우, pod install이 필요하다.
    const p = new Subprocess('pod', ['install'], { cwd: appConfig.iosDir, stdio: 'inherit' });
    await p.run();
}

export { run };
