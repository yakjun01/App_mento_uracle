#!/usr/bin/env node
import {readFileSync} from 'fs'
import {satisfies} from '../dist/semver.js';

const loadJSON = (path) => JSON.parse(readFileSync(new URL(path, import.meta.url)));
const packageJson = loadJSON('../package.json')
const requiresNodeVersion = packageJson.engines.node;

if (!satisfies(process.version, requiresNodeVersion, { includePrerelease: true})) {
  process.stdout.write(
    '\x1b[31m[fatal]\x1b[39m The Morpheus CLI requires NodeJS ' + requiresNodeVersion + '\n' +
    '        Please  install the latest LTS version.\n'
  );

  process.exit(1);
}

import('../dist/main.js').then((cli) => cli.run());