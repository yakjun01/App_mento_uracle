/*! MLocation Plugin 2.1.0.2 [Android 2.1.0.2, iOS 2.1.0.2] */

(function( window, undefined ) {

'use strict';

var pluginVersion = "2.1.0.2";

/**
 * 
 * @class M.location
 */
M.plugin("location", {

	// @TODO: 추후 repeats 옵션 추가 및 STOP api 추가, stop 을 위해 current callback result 값으로 manager 의 고유 ID 회신
	
	'current': function() {
		var defaultSetting, setting, result, context = window, nativeOptions = {};
		
		defaultSetting = M.defaultSetting.create({
			paramsKeys: ["callback"],
			defaultSetting: {
				'callback': function( result ) {
					/**
					 * 
					 */
					M.debug.log( 'M.location.current.callback', result );
				},
				'timeout': 5000,
				'maximumAge': 0,
				'enableHighAccuracy': true
			},
			surrogateKeys: {
				'on': 'callback',
			},
			enumsKeys: {
				
			}
		});
		
		setting = defaultSetting.convert( arguments );

		var response = M.response.on(function( result ) {
			setting.callback.call( context, result, setting );
		});

		nativeOptions.callback = response.toString();
		nativeOptions.timeout = setting.timeout;
		nativeOptions.maximumAge = setting.maximumAge;
		nativeOptions.enableHighAccuracy = setting.enableHighAccuracy === true ? "Y" : "N";
		
		result = M.execute('wn2PluginLocationGetCurrentPosition', nativeOptions);

		if ( result.status !== 'SUCCESS' ) {
			response.execute( result );
		}

		return M;
	}
}, pluginVersion);

})(window);
